<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Global TLS Audit Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .page-break { page-break-after: always; } 
        h1, h2 { color: #2c3e50; }
        .header-block { background-color: #f8f9fa; padding: 15px; border-radius: 5px; border-left: 5px solid #2c3e50; }
        .good { color: green; font-weight: bold; }
        .bad { color: red; font-weight: bold; }
        .warn { color: orange; font-weight: bold; }
        table { border-collapse: collapse; width: 100%; margin-top: 15px; margin-bottom: 30px;}
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>

<center><h1>Global TLS Security Report</h1></center>
<p><i>Generated by TLSClientAudit</i></p>

{% for report in reports %} 

<div class="page-break">
    <div class="header-block">
        <h2>Target: {{ report.server_name }}</h2>
        <p><b>Client IP:</b> {{ report.client_ip }}</p>
        <p><b>Timestamp:</b> {{ report.timestamp }}</p>
        <p><b>Final Grade:</b> 
           <span class="{{ 'bad' if report.final_grade == 'F' else 'good' }}">
               {{ report.final_grade }}
           </span>
        </p>
    </div>

    <h3>1. Passive Analysis</h3>
    <ul>
        <li>SNI: {{ report.passive.sni }}</li>
        <li>Ciphers offered: {{ report.passive.cipher_count }}</li>
        <li>SCSV supported: {{ report.passive.scsv_supported }}</li>
        <li>Weak ciphers offered: {{ report.passive.offered_weak_ciphers | length }}</li>
    </ul>

    <h3>2. Certificate Analysis</h3>
    <ul>
        <li>Key type: {{ report.certificate.key_type }}</li>
        <li>Key size: {{ report.certificate.key_size }} bits</li>
        <li>Signature: {{ report.certificate.signature_algorithm }}</li>
        <li>Weak key: {{ report.certificate.weak_key }}</li>
        <li>Weak signature: {{ report.certificate.weak_signature }}</li>
    </ul>

    <h3>3. Active Attacks</h3>
    <table>
        <tr>
            <th>Step</th>
            <th>Attack</th>
            <th>Details</th>
            <th>Result</th>
        </tr>
        {% for attack in report.attacks %}
        <tr>
            <td>{{ attack.step }}</td>
            <td>{{ attack.attack }}</td>
            <td>{{ attack.details }}</td>
            <td>
                {% if 'SKIPPED' in attack.details %}
                    <span class="warn">SKIPPED</span>
                {% elif attack.success %}
                    <span class="bad">VULNERABLE</span>
                {% else %}
                    <span class="good">BLOCKED</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
    <hr>
</div>

{% endfor %} 
</body>
</html>